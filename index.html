<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MR GAMES+ BETA</title>

  <!-- icons -->
  <link rel="icon" type="image/png" href="favicon.png">
  <link rel="apple-touch-icon" href="/favicon.png">

  <!-- panic cloak -->
  <script src="cloak_panic.js"></script>

  <style>
    html, body { height: 100%; margin: 0; }
    body.dark-mode {
      background:
        radial-gradient(120% 120% at 50% 10%, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0) 40%),
        linear-gradient(160deg, #0f2027 0%, #203a43 40%, #2c5364 100%);
      background-attachment: fixed;
      color: #fff;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    /* header bar */
    header {
      background: #000 !important;
      padding: 12px;
      border: 2px solid #00cfff;
      border-radius: 10px;
      box-shadow:
        0 0 12px #00cfff,
        0 0 24px rgba(0,200,255,0.7),
        inset 0 0 10px rgba(0,200,255,0.4);
      margin: 8px;
      overflow: hidden;
      position: relative;
    }
    header::before {
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(2px 2px at 20% 30%, #00cfff, transparent),
        radial-gradient(1.5px 1.5px at 70% 60%, #00f6ff, transparent),
        radial-gradient(2px 2px at 40% 80%, #00cfff, transparent),
        radial-gradient(1px 1px at 85% 25%, #00f6ff, transparent);
      opacity:.6;
      animation: starShift 12s linear infinite;
    }
    @keyframes starShift { from{transform:translateY(0);} to{transform:translateY(-10%);} }

    .header-content { position:relative; display:flex; justify-content:space-between; align-items:center; z-index:2; }
    .logo { font-size:2rem; font-weight:700; color:#fff; text-shadow:0 0 6px #00cfff,0 0 12px #00cfff; }
    .beta-badge { padding:6px 10px; border-radius:8px; font-weight:700; background:rgba(0,0,0,.25); color:#fff; text-shadow:0 0 6px #f0db4f,0 0 12px #f0db4f; box-shadow:0 0 12px rgba(240,219,79,.5); }

    button {
      background: rgba(0,200,255,.15);
      border:1px solid rgba(0,200,255,.5);
      border-radius:6px;
      padding:.5rem 1rem;
      color:#fff; cursor:pointer;
      text-shadow:0 0 8px #00cfff;
      transition:.25s;
    }
    button:hover { background:rgba(0,200,255,.3); box-shadow:0 0 18px #00cfff; }

    .zone-container h3, .zone-title h2 { text-shadow:0 0 6px #00cfff,0 0 12px #00cfff; }

    /* popup overlay for settings + chat */
    #popupOverlay {
      display:none; position:fixed; inset:0;
      background:rgba(0,0,0,.7);
      z-index:999;
      justify-content:center; align-items:center;
    }
    #popupFrame {
      width:80%; height:80%; border:none;
      border-radius:12px;
      box-shadow:0 0 20px #00cfff;
    }
    #popupOverlay.active { display:flex; }
  </style>
</head>
<body class="dark-mode">
  <div class="mgplus-rain" aria-hidden="true"></div>

  <header>
    <div class="header-content">
      <div style="display:flex;align-items:center;gap:8px;">
        <div class="logo">MR GAMES</div>
        <div class="beta-badge">MR GAMES+ BETA</div>
      </div>
      <div class="search-container">
        <input type="text" id="searchBar" placeholder="Search zones..." oninput="filterZones()">
        <select id="sortOptions" onchange="sortZones()">
          <option value="name">Name</option>
          <option value="id">ID (Date)</option>
          <option value="popular">Popular</option>
        </select>
      </div>
      <div class="control-buttons">
        <button onclick="openSettings()">Settings</button>
        <button onclick="openChat()">VChat</button>
        <button onclick="openPartner()">Partner Code</button>
      </div>
    </div>
  </header>

  <main>
    <details open>
      <summary>Featured Zones</summary>
      <div id="featuredZones" class="zone-container"></div>
    </details>
    <details open>
      <summary>All Zones</summary>
      <div id="container">Loading...</div>
    </details>
  </main>

  <!-- Viewer -->
  <div id="zoneViewer">
    <div class="zone-header">
      <div class="zone-title">
        <h2 id="zoneName">zone</h2>
        <span id="zoneId" style="display:none;"></span>
        <a id="zoneAuthor" href="#" target="_blank">by Author</a>
      </div>
      <div class="zone-controls">
        <button onclick="fullscreenZone()">Fullscreen</button>
        <button onclick="aboutBlank()">New Tab</button>
        <button onclick="downloadZone()">Download</button>
        <button onclick="closeZone()">Close</button>
      </div>
    </div>
    <iframe id="zoneFrame"></iframe>
  </div>

  <footer>
    <div class="footer-links">
      <a href="#" onclick="showContact();return false;">Contact</a>
      <a href="#" onclick="loadPrivacy();return false;">Privacy Policy</a>
    </div>
  </footer>

  <!-- popup overlay -->
  <div id="popupOverlay"><iframe id="popupFrame"></iframe></div>

  <!-- scripts -->
  <script src="script.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/gn-math/gn-math.github.io@main/gnmath.js"></script>

  <script>
    function openSettings(){
      const popup=document.getElementById('popupOverlay');
      const frame=document.getElementById('popupFrame');
      frame.src='settings.html';
      popup.classList.add('active');
    }
    function openChat(){
      const popup=document.getElementById('popupOverlay');
      const frame=document.getElementById('popupFrame');
      frame.src='https://your-firebase-chat-url'; // replace with your chat.html
      popup.classList.add('active');
    }
    function openPartner(){
      const code = Math.random().toString(36).substring(2,8).toUpperCase();
      alert("Your Partner Code: "+code+"\nShare this with a friend!");
    }
    document.getElementById('popupOverlay').addEventListener('click', e=>{
      if(e.target.id==='popupOverlay'){ e.target.classList.remove('active'); }
    });
  </script>
</body>
</html>
